---
layout: post
title: "AUX:パスについて"
version: PPx150以降
date: 2021-11-06
comment: 投稿。
categories: "@AUX"
---
### 説明
PPx1.50以降のバージョンにはaux:パスという機能が用意されています。
これは大仰な言い方をすればPPcを外部コマンドの擬似的なフロントエンドにする機能で、
FTP、androidデバイス、オンラインストレージ、バージョン管理システムなどで管理中
のファイルをPPcのエントリとして操作できます。<BR>
以前は最低限の操作のみ可能でしたが、最近の更新で一通りの操作が可能になっています。<BR>

面白い機能ですが難解でもあり、ヘルプの説明だけでは分からない点が多かった為、
TORO氏にHP掲示板で質問した内容や、自分で確認した範囲で解説をしていきます。<BR>
> aux:パスは未だ更新中の機能です。情報が陳腐化していたり、筆者の勘違い、
間違いがある可能性に留意してください。

#### aux:パス機能の詳細
- aux:パスは仮想パスであり、実体は基本的にリストファイル。
- aux:パスの本体はPPx内部のS\_aux○○○に保存されている。
- S\_aux○○○とS\_○○○では扱いが異なり、S\_aux○○○はaux:ドライブとして認識される。
- S\_○○○はM\_○○○(メニュー設定)と似たようなものだがメニューとしては利用できない。
- aux:パスには二通りの表記方法がある。

  | PPc上のパス | パス区切り | 説明 |
  |:-|:-:|:-|
  | aux:S\_aux○○○\\ | \\ | ローカル(自分のPC内)を示す。 |
  | aux://S\_aux○○○/ | / | リモート(ネットワーク上)を示す。 |
<BR>
- S\_aux○○○は設定できる項目と内容が決まっている。

  | 規定項目 | 補足 ※詳細はヘルプを参照 |
  |:-:|:-|
  | base | 一行編集の補完候補として表示されるが、<BR>aux:パス名を決定するのはメニュー登録名S\_aux○○○であり、<BR>ここで記されるパスがaux:パスになるわけではない。 |
  | list | ここで指定したlistfileがaux:パスとして開かれる。ローカルパスも指定可能。<BR>パスはコマンドの最後に必ず書く必要があり、パスがない場合エラーエントリが表示される。また、リストの変更時に自動で実行される場合がある。<BR>※%Onとしても呼び出されるPPbに反映されない。独自に呼び出しが行われている模様。 |
  | leave | aux:パスを抜けた後に実行。<BR>※%Fの参照などは通常のパスになる。 |
  | overup | 特殊環境変数RootPathより上位に移動したときに実行、その後listが実行される。<BR>※leaveと同じく、aux:パスを抜けた後実行される。 |
  | get<BR>get-d | aux:から別のドライブにエントリをコピーしたときに実行。<BR>`%K"@C"`の実行内容と置き換えられる。 |
  | get-m<BR>get-md | aux:から別のドライブにエントリを移動したときに実行。<BR>`%K@M"`の実行内容と置き換えられ、実行後`list`が実行される。 |
  | store<BR>store-d | 別のドライブからaux:にエントリをコピーしたときに実行。<BR>`%K"@C"`の実行内容と置き換えられ、終了後`list`が実行される。 |
  | store-m<BR>store-dm | 別のドライブからaux:にエントリを移動したときに実行。<BR>`%K"@M"`の実行内容と置き換えられ、終了後`list`が実行される。 |
  | makedir | 新規ディレクトリ作成時。<BR>`%K"@L"`の実行内容と置き換えられ、終了後`list`が実行される。 |
  | rename | リネーム実行時。<BR>`%K"@R"`の実行内容と置き換えられ、終了後`list`が実行される。<BR>※シェルコマンド側でリネームに対応している必要あり。 |
  | copy<BR>copy-d | aux:内の別の場所にエントリをコピーしたときに実行。<BR>`%K"@C"`の実行内容と置き換えられ、終了後`list`が実行される。 |
  | move<BR>move-d | aux:内の別の場所にエントリを移動したときに実行。<BR>`%K"@M"`の実行内容と置き換えられ、終了後`list`が実行される。 |
  | del<BR>deldir | 削除実行時。<BR>`%K"@\D`の実行内容と置き換えられ、終了後`list`が実行される。 |
<BR>
- S\_aux○○○で規定項目以外を設定すると、S\_aux○○○内でのみ使える"%\*関数"になる。<BR>
  `S_aux○○○:msg = *linemessage "abcd" %:`は`%*msg`としてS\_aux○○○内でのみ呼び出せる。<BR>
  また、規定項目以外で`*コマンド`を使用する場合は行末に`%:`を付ける必要がある。<BR>
  > `%*～ は、aux: 内に限られず一番最後の文を呼び出し元に受け渡す処理をしているので、` <BR>
    `最後に実行関係の文を記載すると実行されないケースがあります。`とのこと。
- S\_aux○○○内で\*stringコマンドを使う時は注意が必要。\*string i,aux=1と\*execute %n,\*string i,aux=1は別の変数であり参照元が異なる。前者はS\_aux○○○内でのみ参照可能。

#### aux:パス専用特殊環境変数
- NewPathは次の移動先パスを保持している。
  - `*string i,NewPath=【移動したいパス】`として移動先を変更できる。
- RootPathはaux:パスのルートを設定できる。
  - `*execute %n,*string i,RootPath=【Rootに指定するパス】`とする。
  - ※%si"RootPath"はaux:パスが表示されている限り、PPcを終了しても維持される。

#### aux:パス専用内蔵関数
- パスワードセット時の%\*user、%\*passは`list`コマンド内で使用すること。<BR>
  別の%\*関数経由でのセットではキャンセルしたときに正常終了しない場合あり。

#### aux:パス専用メニュー
- 例えば、aux:S\_auxTest\\ 内を対象とするメニューを出したいならば、
  S\_auxTest.○○○(以降S\_auxTest.abcとする)という項目を作り、
  `?auxabc`を実行すれば表示される。<BR>
- S\_auxTest1.abc、S\_auxTest2.abc、いずれも`?auxabc`で表示されるので
  aux:パスごとの個別メニューに対応できる。

#### aux:パス上の文字マクロ
- 状況によって戻り値が異なるので注意が必要。<BR>
- 例として、PPcでaux:S\_auxTest\\c:\\bin\\ppx\\を開き、ppcw.exeにカーソルを合わせたとする。<BR>
  - aux:パスがlistfileだった場合<BR>
    `%FDC`の中身は`c:\bin\ppx\ppcw.exe`<BR>
    これはlistfileを直接開いた二行目に書いてある`base=○○○`を基準としたパス。
  - aux:パスがlistfileではない(普通のパス)場合<BR>
    `%FDC`の中身は`aux:S_auxTest\c:\bin\ppx\ppcw.exe`<BR>
    リストファイルではなくbaseパスが存在しないため現在のパスになる。

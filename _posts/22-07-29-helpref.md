---
layout: post
title: オフラインヘルプを使い易くする
version: PPx186以降
date: 2022-07-29
comment: 投稿。
repository: tar80/ppm-misc
categories: "@plugin"
---
### 説明

PPxのヘルプは充実していてヘルプを読めばほとんどの問題は解決します。WEBヘルプを直接みてもいいですし、  
htmlをダウンロードしておけばオフラインでの閲覧も可能になります。  
PPxからは`*help`コマンドで直接ヘルプを開け、`*help <検索語>`とすれば
見出し項目へのジャンプが可能です。  
ただヒットしないこともあったりして少し不便に感じたのでヘルプ用の一行編集を作りました。  
ppxwords.htmlに検索をかけ、リストアップした項目からジャンプ先を選ぶ仕組みです。

### 使い方

- 空のまま`ENTER`すると、フレーム付きのヘルプが指定したブラウザで開きます。
  ![sample]({{ site.baseurl }}{% link /public/img/helpref1.png %})  

<BR>

- 文字を入力して`ENTER`するとヒットした見出し項目がメニュー形式でリストアップされます。
  ![sample]({{ site.baseurl }}{% link /public/img/helpref2.png %})  

<BR>

- ヒットなしの場合は再度入力を促します。
  ![sample]({{ site.baseurl }}{% link /public/img/helpref3.png %})  

<BR>

- あくまで見出し検索なので説明文中の文字はヒットしません。関係の無い文字でも見出し内の説明文に含まれて  
  いればヒットします。検索上限は25件となっており、それ以上の検索は打ち切られます。  
  ![sample]({{ site.baseurl }}{% link /public/img/helpref4.png %})  

<BR>
- 文字を入力した場合、`ENTER`では一行編集は終了しないので連続で検索できます。終了は`ESC`キー。  
  検索する度に新しいページが開いてしまうことは善し悪しですが、ブラウザ側の設定や起動オプションで  
  制御できるかもしれません。  
- オフラインヘルプが存在しない場合は自動でダウンロードして指定パスに保存します。  
  ただし、アップデートはされないので自分で更新しなければ古いままのヘルプを使うことになります。  
  `*checkupdate`時にヘルプを自動更新するマクロを組んでおくとよいでしょう。



---
layout: post
title: fileinfoをカスタマイズ
version: PPx185
date: 2022-07-17
comment: 投稿。
repository: 
categories: PPc
---

### 説明

PPxのエントリ情報表示方法はいくつかありますが、自分の求める情報だけさっと確認したいときに、  
`*entrytip fileinfo`では物足りませんし、`CTRL+I`の
エントリ情報表示では雑多な情報が多過ぎます。  
そこで丁度良い感じに表示できるfileinfo用のスクリプトを作ってみました。  
<BR>
スクリプトを実行すると、この様に表示されます。DW版で最初は絵文字に色が付いていましたが  
何回か実行すると色が付かなくなりました。謎。  

![sample]({{ site.baseurl }}{% link /public/img/infotip.png %})

<BR>
このまま使うこともできますが、求める情報は各自違うでしょうから自分でカスタマイズして
みてください。  
スクリプトがわからない人でも簡単に編集できるように作ってあります。  

### スクリプトの編集方法

上から順に説明していきます。  
- 12行目 `NAME_LENGTH`は情報表示名の幅揃えです。表示名より短い場合は無視されます。  
<span style="background-color:gray;color:black;">Extension　　</span>:EXEX64,\*.EXE  
- 13行目`LINE_SEPARETOR`は見出しの区切り線です。一文字だけ`'`か`"`で括って指定します。  
不要であれば非表示にできます(後述)。
- 14行目`EX_COMMENT`は拡張コメントを表示する`true`か、しない`false`かです。`'"`で括りません。
- 15行目`EX_COMMENT_COL`は拡張コメントを何行目から表示させるかです。  
通常は区切り線の下に表示されますが、区切り線を非表示にしている場合に参照されます。
- 62行目`info_tip`は見出し行です。ファイル名が指定されていますが、装飾文字などを加えることもできます。  
['<span style="background-color:gray;color:black;">ここに加えられます</span>' + PPx.Extract('%C')];
- 65行目からは情報の取得をします。上から順番に表示されます。  
  - prop(`項目の固定`, `'表示名'`, `'取得する情報の項目名'`, `/正規表現/`, `'置換文字列'`)。  
    - `項目の固定`は、値が存在しない場合に項目を表示する`true`か、しない`false`かです。  
    `'"`で括らず小文字で指定します。
    - `表示名`はそのままです。好きな名称を付けてください。`'"`で括ります。  
    `'"`で括らず`null`を指定した場合は値だけ表示します。
    - `取得する情報の項目名`は`CTRL+I`(エントリ情報)を参考にしてください。  
    大文字・小文字を正確に記述する必要があり`'"`で括ります。  
    - `正規表現・置換文字列`は値の一部を絞り込みたい場合に使います。  
    また、値にコロン`:`が含まれる場合取得に失敗するので正規表現で除去する必要があります。  
    ※直そうと思ったまま忘れていました。プラグイン作成時に修正します。
  - `info_tip.push(sep_line)`は区切り行です。消してもいいし、増やしても大丈夫です。

#### 設定

スクリプトはutf-8BOMで保存してください。  
実行は`*script path/to/infotip.js`とします。  
第一引数には`*entrytip`のオプションを指定できます。`*script path/to/infotip.js,-combo`  
<BR>

<script src="https://gist.github.com/tar80/b3a0d1df9bec2914cf331c2f3ae85859.js"></script>

